<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[学会用各种姿势备份MySQL数据库]]></title>
      <url>/2017/06/06/%E5%AD%A6%E4%BC%9A%E7%94%A8%E5%90%84%E7%A7%8D%E5%A7%BF%E5%8A%BF%E5%A4%87%E4%BB%BDMySQL%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">我们试着想一想, 在生产环境中什么最重要？如果我们服务器的硬件坏了可以维修或者换新, 软件问题可以修复或重新安装, 但是如果数据没了呢？这可能是最恐怖的事情了吧, 我感觉在生产环境中应该没有什么比数据跟更为重要. 那么我们该如何保证数据不丢失、或者丢失后可以快速恢复呢？只要看完这篇, 大家应该就能对MySQL中实现数据备份和恢复能有一定的了解。</div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="为什么需要备份数据？"><a href="#为什么需要备份数据？" class="headerlink" title="为什么需要备份数据？"></a>为什么需要备份数据？</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">其实在前言中也大概说明了为什么要备份数据, 但是我们还是应该具体了解一下		为什么要备份数据</div><div class="line"></div><div class="line">在生产环境中我们数据库可能会遭遇各种各样的不测从而导致数据丢失, 大概分为以下几种.</div><div class="line"></div><div class="line">· 硬件故障</div><div class="line">· 软件故障</div><div class="line">· 自然灾害</div><div class="line">· 黑客攻击</div><div class="line">· 误操作 (占比最大)</div><div class="line"></div><div class="line">所以, 为了在数据丢失之后能够恢复数据, 我们就需要定期的备份数据, 备份数据的策略要根据不同的应用场景进行定制, 大致有几个参考数值, 我们可以根据这些数值从而定制符合特定环境中的数据备份策略</div><div class="line"></div><div class="line">· 能够容忍丢失多少数据</div><div class="line">· 恢复数据需要多长时间</div><div class="line">· 需要恢复哪一些数据</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> MySql </category>
            
        </categories>
        
        
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>/2017/06/05/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
      
        
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[laravel5.4整合极验验证码3.0]]></title>
      <url>/2017/06/05/laravel5-4%E6%95%B4%E5%90%88%E6%9E%81%E9%AA%8C%E9%AA%8C%E8%AF%81%E7%A0%813-0/</url>
      <content type="html"><![CDATA[<h2 id="注册账号"><a href="#注册账号" class="headerlink" title="注册账号"></a>注册账号</h2><p>注册地址:<a href="http://www.geetest.com/" target="_blank" rel="external">http://www.geetest.com/</a><br>注册之后获得最新的ID和KEY</p>
<h2 id="下载sdk"><a href="#下载sdk" class="headerlink" title="下载sdk"></a>下载sdk</h2><p>把下载下来的sdk改名为geetest放入vendor文件下<br>可以把geetest文件下的其他文件都删除只保留lib文件</p>
<h2 id="把lib下的class-geetestlib-php修改名称为：GeetestLib-class-ph-修改GeetestLib类里的pre-process-方法"><a href="#把lib下的class-geetestlib-php修改名称为：GeetestLib-class-ph-修改GeetestLib类里的pre-process-方法" class="headerlink" title="把lib下的class.geetestlib.php修改名称为：GeetestLib.class.ph 修改GeetestLib类里的pre_process()方法"></a>把lib下的class.geetestlib.php修改名称为：GeetestLib.class.ph 修改GeetestLib类里的pre_process()方法</h2><a id="more"></a>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">pre_process</span><span class="params">($param, $new_captcha=<span class="number">1</span>)</span> </span>&#123;</div><div class="line">        $data = <span class="keyword">array</span>(<span class="string">'gt'</span>=&gt;<span class="keyword">$this</span>-&gt;captcha_id,</div><div class="line">                     <span class="string">'new_captcha'</span>=&gt;$new_captcha</div><div class="line">                );</div><div class="line">        $data = array_merge($data,$param);<span class="comment">//没有修改的这里可能会报错</span></div><div class="line">        $query = http_build_query($data);</div><div class="line">        $url = <span class="string">"http://api.geetest.com/register.php?"</span> . $query;</div><div class="line">        $challenge = <span class="keyword">$this</span>-&gt;send_request($url);</div><div class="line">        <span class="keyword">if</span> (strlen($challenge) != <span class="number">32</span>) &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;failback_process();</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">$this</span>-&gt;success_process($challenge);</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>改成<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">pre_process</span><span class="params">($param, $new_captcha=<span class="number">1</span>)</span> </span>&#123;</div><div class="line">       $data = <span class="keyword">array</span>(<span class="string">'gt'</span>=&gt;<span class="keyword">$this</span>-&gt;captcha_id,</div><div class="line">                    <span class="string">'new_captcha'</span>=&gt;$new_captcha</div><div class="line">               );</div><div class="line">       <span class="keyword">if</span> (($param != <span class="keyword">null</span>) <span class="keyword">and</span> (is_string($param))) &#123;</div><div class="line">           $data[<span class="string">'user_id'</span>] = $param;</div><div class="line">       &#125;</div><div class="line">       $query = http_build_query($data);</div><div class="line">       $url = <span class="string">"http://api.geetest.com/register.php?"</span> . $query;</div><div class="line">       $challenge = <span class="keyword">$this</span>-&gt;send_request($url);</div><div class="line">       <span class="keyword">if</span> (strlen($challenge) != <span class="number">32</span>) &#123;</div><div class="line">           <span class="keyword">$this</span>-&gt;failback_process();</div><div class="line">           <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">$this</span>-&gt;success_process($challenge);</div><div class="line">       <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">   &#125;</div></pre></td></tr></table></figure></p>
<h2 id="在composer-json的autoload内的classmap项新增类包"><a href="#在composer-json的autoload内的classmap项新增类包" class="headerlink" title="在composer.json的autoload内的classmap项新增类包,"></a>在composer.json的autoload内的classmap项新增类包,</h2><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">"autoload": &#123;</div><div class="line">       "classmap": [</div><div class="line">           "database",</div><div class="line">           "vendor/geetest"//添加自己的</div><div class="line">       ],</div><div class="line"></div><div class="line">       "psr-4": &#123;</div><div class="line">           "App\\": "app/"</div><div class="line">       &#125;</div><div class="line">   &#125;,</div></pre></td></tr></table></figure>
<h2 id="运行终端，cd到项目路径，使用composer命令"><a href="#运行终端，cd到项目路径，使用composer命令" class="headerlink" title="运行终端，cd到项目路径，使用composer命令"></a>运行终端，cd到项目路径，使用composer命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">composer dumpautoload</div></pre></td></tr></table></figure>
<p>然后就能在项目中愉快的使用GeetestLib类了，简单的用法如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">use</span> <span class="title">GeetestLib</span>;</div><div class="line">$GtSdk = <span class="keyword">new</span> GeetestLib()</div></pre></td></tr></table></figure></p>
<h2 id="我是在config文件下新建了sys-php做配置文件方便以后在后台修改"><a href="#我是在config文件下新建了sys-php做配置文件方便以后在后台修改" class="headerlink" title="我是在config文件下新建了sys.php做配置文件方便以后在后台修改"></a>我是在config文件下新建了sys.php做配置文件方便以后在后台修改</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*验证码配置*/</span></div><div class="line">   <span class="string">'GEE_ID'</span>  =&gt;  <span class="string">'4c65ff2cf2d4ac493e837a91215fff77'</span>,</div><div class="line">   <span class="string">'GEE_KEY'</span> =&gt;  <span class="string">'e9fc13ecf1178f6a59c80f8f42e5773f'</span>,</div></pre></td></tr></table></figure>
<h2 id="在App-Http-Controllers-下创建Geetest控制器方法getVerify"><a href="#在App-Http-Controllers-下创建Geetest控制器方法getVerify" class="headerlink" title="在App\Http\Controllers 下创建Geetest控制器方法getVerify()"></a>在App\Http\Controllers 下创建Geetest控制器方法getVerify()</h2> <figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">GeetestLib</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">GeetestController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getVerify</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//实例化并传入极验id与key值</span></div><div class="line">        $GtSdk = <span class="keyword">new</span> GeetestLib(config(<span class="string">'sys.GEE_ID'</span>), config(<span class="string">'sys.GEE_KEY'</span>));</div><div class="line">        $user_id = <span class="string">"web"</span>;</div><div class="line">        $status = $GtSdk-&gt;pre_process($user_id);</div><div class="line">        $data = <span class="keyword">array</span>(</div><div class="line">            <span class="string">'gtserver'</span>=&gt;$status,</div><div class="line">            <span class="string">'user_id'</span>=&gt;$user_id</div><div class="line">        );</div><div class="line">        session([<span class="string">'geetest'</span>=&gt;$data]);</div><div class="line"></div><div class="line">        <span class="keyword">echo</span> $GtSdk-&gt;get_response_str();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 创建路由<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Route::get(&apos;/getVerify&apos;, &apos;GeetestController@getVerify&apos;)-&gt;name(&apos;getVerify&apos;);</div></pre></td></tr></table></figure></p>
<h2 id="在页面上处理"><a href="#在页面上处理" class="headerlink" title="在页面上处理"></a>在页面上处理</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div></pre></td><td class="code"><pre><div class="line">@extends('layouts.app')</div><div class="line"></div><div class="line">@section('content')</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-8 col-md-offset-2"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span> <span class="attr">role</span>=<span class="string">"form"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">action</span>=<span class="string">"&#123;&#123; route('login') &#125;&#125;"</span>&gt;</span></div><div class="line">                        &#123;&#123; csrf_field() &#125;&#125;</div><div class="line"></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group&#123;&#123; $errors-&gt;has('email') ? ' has-error' : '' &#125;&#125;"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"col-md-4 control-label"</span>&gt;</span>E-Mail Address<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"></div><div class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></div><div class="line">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"email"</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; old('email') &#125;&#125;"</span> <span class="attr">required</span> <span class="attr">autofocus</span>&gt;</span></div><div class="line"></div><div class="line">                                @if ($errors-&gt;has('email'))</div><div class="line">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span></div><div class="line">                                        <span class="tag">&lt;<span class="name">strong</span>&gt;</span>&#123;&#123; $errors-&gt;first('email') &#125;&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></div><div class="line">                                    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                                @endif</div><div class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group&#123;&#123; $errors-&gt;has('password') ? ' has-error' : '' &#125;&#125;"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"col-md-4 control-label"</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"></div><div class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></div><div class="line">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"password"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">required</span>&gt;</span></div><div class="line"></div><div class="line">                                @if ($errors-&gt;has('password'))</div><div class="line">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span></div><div class="line">                                        <span class="tag">&lt;<span class="name">strong</span>&gt;</span>&#123;&#123; $errors-&gt;first('password') &#125;&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></div><div class="line">                                    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                                @endif</div><div class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"embed-captcha"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"wait"</span> <span class="attr">class</span>=<span class="string">"show"</span>&gt;</span>正在加载验证码......<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"notice"</span> <span class="attr">class</span>=<span class="string">"hide"</span>&gt;</span>请先拖动验证码到相应位置<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6 col-md-offset-4"</span>&gt;</span></div><div class="line">                                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></div><div class="line">                                    <span class="tag">&lt;<span class="name">label</span>&gt;</span></div><div class="line">                                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"remember"</span> &#123;&#123; <span class="attr">old</span>('<span class="attr">remember</span>') ? '<span class="attr">checked</span>' <span class="attr">:</span> '' &#125;&#125;&gt;</span> Remember Me</div><div class="line">                                    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">                                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-8 col-md-offset-4"</span>&gt;</span></div><div class="line">                                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">id</span>=<span class="string">"but"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">disabled</span>&gt;</span></div><div class="line">                                    Login</div><div class="line">                                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"></div><div class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-link"</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; route('password.request') &#125;&#125;"</span>&gt;</span></div><div class="line">                                    Forgot Your Password?</div><div class="line">                                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://libs.baidu.com/jquery/1.9.0/jquery.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 引入封装了failback的接口--initGeetest --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://static.geetest.com/static/tools/gt.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line">        var handlerEmbed = function (captchaObj) &#123;</div><div class="line">            $("#embed-submit").click(function (e) &#123;</div><div class="line"></div><div class="line">                var validate = captchaObj.getValidate();</div><div class="line">                if (!validate) &#123;</div><div class="line">                    $("#notice")[0].className = "show";</div><div class="line">                    setTimeout(function () &#123;</div><div class="line">                        $("#notice")[0].className = "hide";</div><div class="line"></div><div class="line">                    &#125;, 2000);</div><div class="line">                    e.preventDefault();</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            // 将验证码加到id为captcha的元素里</div><div class="line">            captchaObj.appendTo("#embed-captcha");</div><div class="line">            captchaObj.onReady(function () &#123;</div><div class="line">                $("#wait")[0].className = "hide";</div><div class="line">            &#125;);</div><div class="line">            //验证成功</div><div class="line">            captchaObj.onSuccess(function () &#123;</div><div class="line">                $("#but").attr("disabled",false)</div><div class="line">            &#125;);</div><div class="line">            //验证失败</div><div class="line">            captchaObj.onError(function () &#123;</div><div class="line">                $("#but").attr("disabled",true)</div><div class="line">            &#125;);</div><div class="line">            // 更多接口参考：http://www.geetest.com/install/sections/idx-client-sdk.html</div><div class="line">        &#125;;</div><div class="line">        $.ajax(&#123;</div><div class="line">            // 获取id，challenge，success（是否启用failback）</div><div class="line">            url: "&#123;&#123; route('getVerify',array('t'=&gt;time())) &#125;&#125;", // 加随机数防止缓存</div><div class="line">            type: "get",</div><div class="line">            dataType: "json",</div><div class="line">            success: function (data) &#123;</div><div class="line">                console.log(data)</div><div class="line">                // 使用initGeetest接口</div><div class="line">                // 参数1：配置参数</div><div class="line">                // 参数2：回调，回调的第一个参数验证码对象，之后可以使用它做appendTo之类的事件</div><div class="line">                initGeetest(&#123;</div><div class="line">                    gt: data.gt,</div><div class="line">                    challenge: data.challenge,</div><div class="line">                    product: "float", // 产品形式，包括：float，embed，popup。注意只对PC版验证码有效</div><div class="line">                    offline: !data.success // 表示用户后台检测极验服务器是否宕机，一般不需要关注</div><div class="line">                &#125;, handlerEmbed);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">@endsection</div></pre></td></tr></table></figure>
<h2 id="初始化完成之后的提交时前段会自动验证，然后提交给后台之后处理方法是："><a href="#初始化完成之后的提交时前段会自动验证，然后提交给后台之后处理方法是：" class="headerlink" title="初始化完成之后的提交时前段会自动验证，然后提交给后台之后处理方法是："></a>初始化完成之后的提交时前段会自动验证，然后提交给后台之后处理方法是：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    $GtSdk = GeetestLib(config(<span class="string">'sys.GEE_ID'</span>), config(<span class="string">'sys.GEE_KEY'</span>));</div><div class="line">    $geetest = session(<span class="string">"geetest"</span>);</div><div class="line">    $user_id = $geetest[<span class="string">'user_id'</span>];);</div><div class="line">    <span class="keyword">if</span> ($geetest[<span class="string">'gtserver'</span>] == <span class="number">1</span>) &#123;</div><div class="line">        $result = $GtSdk-&gt;success_validate($geetest_challenge, $geetest_validate, $geetest_seccode, $user_id);</div><div class="line">        <span class="keyword">if</span> ($result) &#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">'Yes!'</span>;</div><div class="line">        &#125; <span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">'No'</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">       <span class="keyword">if</span> ($GtSdk-&gt;fail_validate($geetest_challenge, $geetest_validate, $geetest_seccode)) &#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"yes"</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"no"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="然后在页面上就可以看到效果了。"><a href="#然后在页面上就可以看到效果了。" class="headerlink" title="然后在页面上就可以看到效果了。"></a>然后在页面上就可以看到效果了。</h2><p><img src="http://ac-HSNl7zbI.clouddn.com/5DW5lXOGECJCEtWTAmdFusPSXqMwUmA0jyLjRAar.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> php </category>
            
            <category> laravel </category>
            
        </categories>
        
        
        <tags>
            
            <tag> laravel </tag>
            
            <tag> geetest </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Centos初始化]]></title>
      <url>/2017/01/03/CentOS-1-3/</url>
      <content type="html"><![CDATA[<h2 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h2><h3 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup</div></pre></td></tr></table></figure>
<h3 id="写入国内源-centos-7"><a href="#写入国内源-centos-7" class="headerlink" title="写入国内源(centos 7)"></a>写入国内源(centos 7)</h3><p>ustc： <a href="https://lug.ustc.edu.cn/wiki/mirrors/help/centos" target="_blank" rel="external">https://lug.ustc.edu.cn/wiki/mirrors/help/centos</a></p>
<a id="more"></a>
<p>163：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"># CentOS-Base.repo</div><div class="line">#</div><div class="line"># The mirror system uses the connecting IP address of the client and the</div><div class="line"># update status of each mirror to pick mirrors that are updated to and</div><div class="line"># geographically close to the client.  You should use this for CentOS updates</div><div class="line"># unless you are manually picking other mirrors.</div><div class="line">#</div><div class="line"># If the mirrorlist= does not work for you, as a fall back you can try the</div><div class="line"># remarked out baseurl= line instead.</div><div class="line">#</div><div class="line">#</div><div class="line">[base]</div><div class="line">name=CentOS-$releasever - Base - 163.com</div><div class="line">#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os</div><div class="line">baseurl=http://mirrors.163.com/centos/$releasever/os/$basearch/</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7</div><div class="line"></div><div class="line">#released updates</div><div class="line">[updates]</div><div class="line">name=CentOS-$releasever - Updates - 163.com</div><div class="line">#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updates</div><div class="line">baseurl=http://mirrors.163.com/centos/$releasever/updates/$basearch/</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7</div><div class="line"></div><div class="line">#additional packages that may be useful</div><div class="line">[extras]</div><div class="line">name=CentOS-$releasever - Extras - 163.com</div><div class="line">#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extras</div><div class="line">baseurl=http://mirrors.163.com/centos/$releasever/extras/$basearch/</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7</div><div class="line"></div><div class="line">#additional packages that extend functionality of existing packages</div><div class="line">[centosplus]</div><div class="line">name=CentOS-$releasever - Plus - 163.com</div><div class="line">baseurl=http://mirrors.163.com/centos/$releasever/centosplus/$basearch/</div><div class="line">gpgcheck=1</div><div class="line">enabled=0</div><div class="line">gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7</div></pre></td></tr></table></figure>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yum clean all</div><div class="line">yum makecache</div></pre></td></tr></table></figure>
<h2 id="设置代理"><a href="#设置代理" class="headerlink" title="设置代理"></a>设置代理</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#! /bin/bash</span></div><div class="line"><span class="comment"># Author: Kevin Tan</span></div><div class="line"><span class="comment"># Update-Date: 2017-1-14</span></div><div class="line">URL=<span class="variable">$1</span></div><div class="line">ACTION=(<span class="string">'\nSet'</span> <span class="string">'\nDel'</span>)</div><div class="line">mode=1</div><div class="line"><span class="keyword">if</span> [ -z <span class="variable">$URL</span> ]; <span class="keyword">then</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">'[Warning]: URL parameter is empty, default action change to remove'</span></div><div class="line">    mode=2</div><div class="line"><span class="keyword">fi</span></div><div class="line"><span class="function"><span class="title">set_proxy</span></span>()&#123;</div><div class="line">  file=<span class="variable">$1</span>;prefix=<span class="variable">$2</span>;value=<span class="string">"<span class="variable">$2</span>=<span class="variable">$3</span>"</span>;</div><div class="line">  <span class="built_in">echo</span> <span class="string">"Set \"<span class="variable">$value</span>\" to \"<span class="variable">$file</span>\""</span></div><div class="line">  <span class="keyword">if</span> [ -e <span class="string">"<span class="variable">$file</span>"</span> ]; <span class="keyword">then</span></div><div class="line">    <span class="keyword">if</span> grep -q <span class="string">"^\s*<span class="variable">$prefix</span>"</span> <span class="string">"<span class="variable">$file</span>"</span>; <span class="keyword">then</span></div><div class="line">        sed -i <span class="string">"s#^\s*<span class="variable">$prefix</span>=.*#<span class="variable">$value</span>#g"</span> <span class="variable">$file</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="built_in">echo</span> <span class="variable">$value</span> &gt;&gt; <span class="variable">$file</span></div><div class="line">    <span class="keyword">fi</span></div><div class="line">  <span class="keyword">fi</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="title">del_proxy</span></span>()&#123;</div><div class="line">    file=<span class="variable">$1</span>;prefix=<span class="variable">$2</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">"Del \"<span class="variable">$prefix</span>\" from \"<span class="variable">$file</span>\""</span></div><div class="line">    <span class="keyword">if</span> [ -e <span class="string">"<span class="variable">$file</span>"</span> ]; <span class="keyword">then</span></div><div class="line">        sed -i <span class="string">"/^\s*<span class="variable">$prefix</span>=.*/d"</span> <span class="variable">$file</span></div><div class="line">    <span class="keyword">fi</span></div><div class="line">    <span class="built_in">eval</span> <span class="variable">$prefix</span>=<span class="string">""</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">SHELL_NAME=`ps -p $$ | awk <span class="string">'NR==2 &#123;print $4&#125;'</span>`</div><div class="line"><span class="built_in">echo</span> <span class="string">'Current shell is '</span><span class="variable">$SHELL_NAME</span></div><div class="line"><span class="function"><span class="title">source_file</span></span>()&#123;</div><div class="line">    <span class="comment">## bash</span></div><div class="line">    <span class="keyword">if</span> [ <span class="string">"<span class="variable">$SHELL_NAME</span>"</span> = <span class="string">"bash"</span> ]; <span class="keyword">then</span></div><div class="line">        <span class="built_in">source</span> <span class="variable">$HOME</span><span class="string">'/.bashrc'</span></div><div class="line">    <span class="keyword">fi</span></div><div class="line">    <span class="comment">## zsh</span></div><div class="line">    <span class="keyword">if</span> [ <span class="string">"<span class="variable">$SHELL_NAME</span>"</span> = <span class="string">"zsh"</span> ]; <span class="keyword">then</span></div><div class="line">        <span class="built_in">source</span> <span class="variable">$HOME</span><span class="string">'/.zshrc'</span></div><div class="line">    <span class="keyword">fi</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment"># yum</span></div><div class="line"><span class="built_in">echo</span> -n <span class="variable">$&#123;ACTION[$mode]&#125;</span><span class="string">' the yum? (y/n/r) '</span>;<span class="built_in">read</span> F</div><div class="line"><span class="keyword">if</span> [ <span class="variable">$F</span> = <span class="string">'y'</span> ] &amp;&amp; [ <span class="variable">$mode</span> -eq 1 ]; <span class="keyword">then</span></div><div class="line">    set_proxy <span class="string">'/etc/yum.conf'</span> <span class="string">'proxy'</span> <span class="variable">$URL</span></div><div class="line"><span class="keyword">elif</span> [ <span class="variable">$F</span> = <span class="string">'r'</span> ] || ([ <span class="variable">$F</span> = <span class="string">'y'</span> ] &amp;&amp; [ <span class="variable">$mode</span> -eq 2 ]); <span class="keyword">then</span></div><div class="line">    del_proxy <span class="string">'/etc/yum.conf'</span> <span class="string">'proxy'</span></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="comment"># environment</span></div><div class="line"><span class="built_in">echo</span> -n <span class="variable">$&#123;ACTION[$mode]&#125;</span><span class="string">' the environment var?(y/n/r) '</span>;<span class="built_in">read</span> F</div><div class="line">shell_names=(zsh bash)</div><div class="line"><span class="keyword">if</span> [ <span class="variable">$F</span> = <span class="string">'y'</span> ] &amp;&amp; [ <span class="variable">$mode</span> -eq 1 ]; <span class="keyword">then</span></div><div class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> <span class="variable">$&#123;shell_names[@]&#125;</span>; <span class="keyword">do</span></div><div class="line">        set_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export http_proxy"</span> <span class="variable">$URL</span></div><div class="line">        set_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export https_proxy"</span> <span class="variable">$URL</span></div><div class="line">    <span class="keyword">done</span></div><div class="line">    source_file</div><div class="line"><span class="keyword">elif</span> [ <span class="variable">$F</span> = <span class="string">'r'</span> ] || ([ <span class="variable">$F</span> = <span class="string">'y'</span> ] &amp;&amp; [ <span class="variable">$mode</span> -eq 2 ]); <span class="keyword">then</span></div><div class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> <span class="variable">$&#123;shell_names[@]&#125;</span>; <span class="keyword">do</span></div><div class="line">        del_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export http_proxy"</span></div><div class="line">        del_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export https_proxy"</span></div><div class="line">    <span class="keyword">done</span></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="comment">#curl</span></div><div class="line"><span class="built_in">echo</span> -n <span class="variable">$&#123;ACTION[$mode]&#125;</span><span class="string">' the curl proxy alias?(y/n/r) '</span>;<span class="built_in">read</span> F</div><div class="line">shell_names=(zsh bash)</div><div class="line"><span class="keyword">if</span> [ <span class="variable">$F</span> = <span class="string">'y'</span> ] &amp;&amp; [ <span class="variable">$mode</span> -eq 1 ]; <span class="keyword">then</span></div><div class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> <span class="variable">$&#123;shell_names[@]&#125;</span>; <span class="keyword">do</span></div><div class="line">    	set_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"alias curl"</span> <span class="string">"\"curl -x <span class="variable">$URL</span>\""</span>   </div><div class="line">    <span class="keyword">done</span></div><div class="line">    source_file</div><div class="line"><span class="keyword">elif</span> [ <span class="variable">$F</span> = <span class="string">'r'</span> ] || ([ <span class="variable">$F</span> = <span class="string">'y'</span> ] &amp;&amp; [ <span class="variable">$mode</span> -eq 2 ]); <span class="keyword">then</span></div><div class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> <span class="variable">$&#123;shell_names[@]&#125;</span>; <span class="keyword">do</span></div><div class="line">        del_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"alias curl"</span></div><div class="line">        <span class="built_in">unalias</span> curl</div><div class="line">    <span class="keyword">done</span></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="comment"># kubernetes</span></div><div class="line"><span class="built_in">echo</span> -n <span class="variable">$&#123;ACTION[$mode]&#125;</span><span class="string">' kube environment var?(y/n/r) '</span>;<span class="built_in">read</span> F</div><div class="line"><span class="keyword">if</span> [ <span class="variable">$F</span> = <span class="string">'y'</span> ] &amp;&amp; [ <span class="variable">$mode</span> -eq 1 ]; <span class="keyword">then</span></div><div class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> <span class="variable">$&#123;shell_names[@]&#125;</span>; <span class="keyword">do</span></div><div class="line">        set_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export KUBERNETES_HTTP_PROXY"</span> <span class="variable">$URL</span></div><div class="line">        set_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export KUBERNETES_HTTPS_PROXY"</span> <span class="variable">$URL</span></div><div class="line">        set_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export KUBE_BUILD_HTTPS_PROXY"</span> <span class="variable">$URL</span></div><div class="line">        set_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export KUBE_BUILD_HTTP_PROXY"</span> <span class="variable">$URL</span></div><div class="line">    <span class="keyword">done</span></div><div class="line">    source_file</div><div class="line"><span class="keyword">elif</span> [ <span class="variable">$F</span> = <span class="string">'r'</span> ] || ([ <span class="variable">$F</span> = <span class="string">'y'</span> ] &amp;&amp; [ <span class="variable">$mode</span> -eq 2 ]); <span class="keyword">then</span></div><div class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> <span class="variable">$&#123;shell_names[@]&#125;</span>; <span class="keyword">do</span></div><div class="line">        del_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export KUBERNETES_HTTP_PROXY"</span></div><div class="line">        del_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export KUBERNETES_HTTPS_PROXY"</span></div><div class="line">        del_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export KUBE_BUILD_HTTPS_PROXY"</span></div><div class="line">        del_proxy <span class="string">"<span class="variable">$HOME</span>/.<span class="variable">$&#123;name&#125;</span>rc"</span> <span class="string">"export KUBE_BUILD_HTTP_PROXY"</span></div><div class="line">    <span class="keyword">done</span></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="comment"># docker</span></div><div class="line"><span class="built_in">echo</span> -n <span class="variable">$&#123;ACTION[$mode]&#125;</span><span class="string">' the docker?(y/n/r) '</span>;<span class="built_in">read</span> F</div><div class="line"><span class="keyword">if</span> <span class="built_in">type</span> <span class="string">"docker"</span> &amp;&gt;/dev/null &amp;&amp; ([ <span class="variable">$F</span> = <span class="string">'y'</span> ] || [ <span class="variable">$F</span> = <span class="string">'r'</span> ]); <span class="keyword">then</span></div><div class="line">        DOCKER_CONF_DIR=<span class="string">'/etc/systemd/system/docker.service.d'</span></div><div class="line">        DOCKER_CONF=<span class="variable">$DOCKER_CONF_DIR</span><span class="string">'/http-proxy.conf'</span></div><div class="line">        REGISTRY=<span class="string">"87129800.m.daodocker.io"</span></div><div class="line">        sudo mkdir -p <span class="string">"<span class="variable">$DOCKER_CONF_DIR</span>"</span></div><div class="line">        sudo rm -rf <span class="variable">$DOCKER_CONF</span></div><div class="line">        <span class="keyword">if</span> [ <span class="variable">$F</span> = <span class="string">'y'</span> ] &amp;&amp; [ <span class="variable">$mode</span> -eq 1 ]; <span class="keyword">then</span></div><div class="line">            <span class="built_in">printf</span> <span class="string">"[Service]\nEnvironment="</span> | sudo tee <span class="variable">$DOCKER_CONF</span> &gt; /dev/null</div><div class="line">            <span class="built_in">printf</span> <span class="string">"\"HTTP_PROXY=%s\" "</span> <span class="variable">$URL</span> | sudo tee -a <span class="variable">$DOCKER_CONF</span> &gt; /dev/null</div><div class="line">            <span class="built_in">printf</span> <span class="string">"\"HTTPS_PROXY=%s\" "</span> <span class="variable">$URL</span> | sudo tee -a <span class="variable">$DOCKER_CONF</span> &gt; /dev/null</div><div class="line">            <span class="built_in">printf</span> <span class="string">"\"NO_PROXY=localhost,%s\""</span> <span class="variable">$REGISTRY</span> | sudo tee -a <span class="variable">$DOCKER_CONF</span> &gt; /dev/null</div><div class="line">        <span class="keyword">fi</span></div><div class="line">        sudo systemctl daemon-reload</div><div class="line">        sudo systemctl restart docker</div><div class="line">        <span class="built_in">echo</span> <span class="string">"Daemon reloaded"</span></div><div class="line">        systemctl show --property=Environment docker</div><div class="line"><span class="keyword">fi</span></div></pre></td></tr></table></figure>
<p>将上面脚本保持为setproxy，然后执行,注意，如果当前环境下已经有了http_proxy等变量。则需要我们手动reset</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chmod u+x setproxy</div><div class="line"><span class="built_in">source</span> setproxy http://10.100.100.136:4411</div></pre></td></tr></table></figure>
<h2 id="基础建设"><a href="#基础建设" class="headerlink" title="基础建设"></a>基础建设</h2><h3 id="git-amp-amp-gcc"><a href="#git-amp-amp-gcc" class="headerlink" title="git &amp;&amp; gcc"></a>git &amp;&amp; gcc</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install git gcc</div></pre></td></tr></table></figure>
<h3 id="pip"><a href="#pip" class="headerlink" title="pip"></a>pip</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl <span class="string">"https://bootstrap.pypa.io/get-pip.py"</span> | python</div></pre></td></tr></table></figure>
<p>EPEL</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rpm -ivh http://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</div></pre></td></tr></table></figure>
<h2 id="ZSH"><a href="#ZSH" class="headerlink" title="ZSH"></a>ZSH</h2><h3 id="安装-amp-激活"><a href="#安装-amp-激活" class="headerlink" title="安装 &amp; 激活"></a>安装 &amp; 激活</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yum install zsh</div><div class="line">chsh -s /bin/zsh</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> centos </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
