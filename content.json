{"meta":{"title":"Cjade","subtitle":"Only when you plant the flowers can you really smell their fragrance.","description":"start from zero","author":"Cjade","url":"http://mcoo.me"},"pages":[],"posts":[{"title":"laravel5.4整合极验验证码3.0","slug":"laravel5-4整合极验验证码3-0","date":"2017-06-05T10:06:27.000Z","updated":"2017-06-05T10:51:50.000Z","comments":true,"path":"2017/06/05/laravel5-4整合极验验证码3-0/","link":"","permalink":"http://mcoo.me/2017/06/05/laravel5-4整合极验验证码3-0/","excerpt":"","text":"注册账号注册地址:http://www.geetest.com/注册之后获得最新的ID和KEY2·下载sdk把下载下来的sdk改名为geetest放入vendor文件下可以把geetest文件下的其他文件都删除只保留lib文件 3·把lib下的class.geetestlib.php修改名称为：GeetestLib.class.ph 修改GeetestLib类里的pre_process()方法 123456789101112131415public function pre_process($param, $new_captcha=1) &#123; $data = array('gt'=&gt;$this-&gt;captcha_id, 'new_captcha'=&gt;$new_captcha ); $data = array_merge($data,$param);//没有修改的这里可能会报错 $query = http_build_query($data); $url = \"http://api.geetest.com/register.php?\" . $query; $challenge = $this-&gt;send_request($url); if (strlen($challenge) != 32) &#123; $this-&gt;failback_process(); return 0; &#125; $this-&gt;success_process($challenge); return 1; &#125; 改成1234567891011121314151617public function pre_process($param, $new_captcha=1) &#123; $data = array('gt'=&gt;$this-&gt;captcha_id, 'new_captcha'=&gt;$new_captcha ); if (($param != null) and (is_string($param))) &#123; $data['user_id'] = $param; &#125; $query = http_build_query($data); $url = \"http://api.geetest.com/register.php?\" . $query; $challenge = $this-&gt;send_request($url); if (strlen($challenge) != 32) &#123; $this-&gt;failback_process(); return 0; &#125; $this-&gt;success_process($challenge); return 1; &#125; 4·在composer.json的autoload内的classmap项新增类包,12345678910\"autoload\": &#123; \"classmap\": [ \"database\", \"vendor/geetest\"//添加自己的 ], \"psr-4\": &#123; \"App\\\\\": \"app/\" &#125; &#125;, 5·运行终端，cd到项目路径，使用composer命令1composer dumpautoload 然后就能在项目中愉快的使用GeetestLib类了，简单的用法如下：12use GeetestLib;$GtSdk = new GeetestLib() 6·我是在config文件下新建了sys.php做配置文件方便以后在后台修改123/*验证码配置*/ 'GEE_ID' =&gt; '4c65ff2cf2d4ac493e837a91215fff77', 'GEE_KEY' =&gt; 'e9fc13ecf1178f6a59c80f8f42e5773f', 7·在App\\Http\\Controllers 下创建Geetest控制器方法getVerify() 12345678910111213141516171819namespace App\\Http\\Controllers;use GeetestLib;class GeetestController extends Controller&#123; public function getVerify()&#123; //实例化并传入极验id与key值 $GtSdk = new GeetestLib(config('sys.GEE_ID'), config('sys.GEE_KEY')); $user_id = \"web\"; $status = $GtSdk-&gt;pre_process($user_id); $data = array( 'gtserver'=&gt;$status, 'user_id'=&gt;$user_id ); session(['geetest'=&gt;$data]); echo $GtSdk-&gt;get_response_str(); &#125;&#125; 创建路由1Route::get(&apos;/getVerify&apos;, &apos;GeetestController@getVerify&apos;)-&gt;name(&apos;getVerify&apos;); 8·在页面上处理 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125@extends('layouts.app')@section('content')&lt;div class=\"container\"&gt; &lt;div class=\"row\"&gt; &lt;div class=\"col-md-8 col-md-offset-2\"&gt; &lt;div class=\"panel panel-default\"&gt; &lt;div class=\"panel-heading\"&gt;Login&lt;/div&gt; &lt;div class=\"panel-body\"&gt; &lt;form class=\"form-horizontal\" role=\"form\" method=\"POST\" action=\"&#123;&#123; route('login') &#125;&#125;\"&gt; &#123;&#123; csrf_field() &#125;&#125; &lt;div class=\"form-group&#123;&#123; $errors-&gt;has('email') ? ' has-error' : '' &#125;&#125;\"&gt; &lt;label for=\"email\" class=\"col-md-4 control-label\"&gt;E-Mail Address&lt;/label&gt; &lt;div class=\"col-md-6\"&gt; &lt;input id=\"email\" type=\"email\" class=\"form-control\" name=\"email\" value=\"&#123;&#123; old('email') &#125;&#125;\" required autofocus&gt; @if ($errors-&gt;has('email')) &lt;span class=\"help-block\"&gt; &lt;strong&gt;&#123;&#123; $errors-&gt;first('email') &#125;&#125;&lt;/strong&gt; &lt;/span&gt; @endif &lt;/div&gt; &lt;/div&gt; &lt;div class=\"form-group&#123;&#123; $errors-&gt;has('password') ? ' has-error' : '' &#125;&#125;\"&gt; &lt;label for=\"password\" class=\"col-md-4 control-label\"&gt;Password&lt;/label&gt; &lt;div class=\"col-md-6\"&gt; &lt;input id=\"password\" type=\"password\" class=\"form-control\" name=\"password\" required&gt; @if ($errors-&gt;has('password')) &lt;span class=\"help-block\"&gt; &lt;strong&gt;&#123;&#123; $errors-&gt;first('password') &#125;&#125;&lt;/strong&gt; &lt;/span&gt; @endif &lt;/div&gt; &lt;/div&gt; &lt;div id=\"embed-captcha\"&gt;&lt;/div&gt; &lt;p id=\"wait\" class=\"show\"&gt;正在加载验证码......&lt;/p&gt; &lt;p id=\"notice\" class=\"hide\"&gt;请先拖动验证码到相应位置&lt;/p&gt; &lt;div class=\"form-group\"&gt; &lt;div class=\"col-md-6 col-md-offset-4\"&gt; &lt;div class=\"checkbox\"&gt; &lt;label&gt; &lt;input type=\"checkbox\" name=\"remember\" &#123;&#123; old('remember') ? 'checked' : '' &#125;&#125;&gt; Remember Me &lt;/label&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\"form-group\"&gt; &lt;div class=\"col-md-8 col-md-offset-4\"&gt; &lt;button type=\"submit\" id=\"but\" class=\"btn btn-primary\" disabled&gt; Login &lt;/button&gt; &lt;a class=\"btn btn-link\" href=\"&#123;&#123; route('password.request') &#125;&#125;\"&gt; Forgot Your Password? &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; &lt;script src=\"http://libs.baidu.com/jquery/1.9.0/jquery.js\"&gt;&lt;/script&gt; &lt;!-- 引入封装了failback的接口--initGeetest --&gt; &lt;script src=\"http://static.geetest.com/static/tools/gt.js\"&gt;&lt;/script&gt; &lt;script&gt; var handlerEmbed = function (captchaObj) &#123; $(\"#embed-submit\").click(function (e) &#123; var validate = captchaObj.getValidate(); if (!validate) &#123; $(\"#notice\")[0].className = \"show\"; setTimeout(function () &#123; $(\"#notice\")[0].className = \"hide\"; &#125;, 2000); e.preventDefault(); &#125; &#125;); // 将验证码加到id为captcha的元素里 captchaObj.appendTo(\"#embed-captcha\"); captchaObj.onReady(function () &#123; $(\"#wait\")[0].className = \"hide\"; &#125;); //验证成功 captchaObj.onSuccess(function () &#123; $(\"#but\").attr(\"disabled\",false) &#125;); //验证失败 captchaObj.onError(function () &#123; $(\"#but\").attr(\"disabled\",true) &#125;); // 更多接口参考：http://www.geetest.com/install/sections/idx-client-sdk.html &#125;; $.ajax(&#123; // 获取id，challenge，success（是否启用failback） url: \"&#123;&#123; route('getVerify',array('t'=&gt;time())) &#125;&#125;\", // 加随机数防止缓存 type: \"get\", dataType: \"json\", success: function (data) &#123; console.log(data) // 使用initGeetest接口 // 参数1：配置参数 // 参数2：回调，回调的第一个参数验证码对象，之后可以使用它做appendTo之类的事件 initGeetest(&#123; gt: data.gt, challenge: data.challenge, product: \"float\", // 产品形式，包括：float，embed，popup。注意只对PC版验证码有效 offline: !data.success // 表示用户后台检测极验服务器是否宕机，一般不需要关注 &#125;, handlerEmbed); &#125; &#125;); &lt;/script&gt;@endsection 9·初始化完成之后的提交时前段会自动验证，然后提交给后台之后处理方法是： 1234567891011121314151617181920public function login()&#123; $GtSdk = GeetestLib(config('sys.GEE_ID'), config('sys.GEE_KEY')); $geetest = session(\"geetest\"); $user_id = $geetest['user_id'];); if ($geetest['gtserver'] == 1) &#123; $result = $GtSdk-&gt;success_validate($geetest_challenge, $geetest_validate, $geetest_seccode, $user_id); if ($result) &#123; echo 'Yes!'; &#125; else&#123; echo 'No'; &#125; &#125;else&#123; if ($GtSdk-&gt;fail_validate($geetest_challenge, $geetest_validate, $geetest_seccode)) &#123; echo \"yes\"; &#125;else&#123; echo \"no\"; &#125; &#125;&#125; 然后在页面上就可以看到效果了。","categories":[],"tags":[{"name":"laravel5.4","slug":"laravel5-4","permalink":"http://mcoo.me/tags/laravel5-4/"}]},{"title":"hello-world","slug":"hello-world-1","date":"2017-06-05T09:05:12.000Z","updated":"2017-06-05T09:06:29.000Z","comments":true,"path":"2017/06/05/hello-world-1/","link":"","permalink":"http://mcoo.me/2017/06/05/hello-world-1/","excerpt":"","text":"你好！","categories":[],"tags":[]},{"title":"Hello World","slug":"hello-world","date":"2017-06-05T08:54:33.000Z","updated":"2017-06-05T08:54:33.000Z","comments":true,"path":"2017/06/05/hello-world/","link":"","permalink":"http://mcoo.me/2017/06/05/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}]}